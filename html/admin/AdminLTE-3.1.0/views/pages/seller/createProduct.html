<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin</title>
  <!-- bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="../../../plugins/fontawesome-free/css/all.min.css">
  <!-- overlayScrollbars -->
  <link rel="stylesheet" href="../../../plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../../dist/css/adminlte.min.css">
  <!-- Link icon -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  <!-- Angular js -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
  <!-- Angular Router -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular-route.js"></script>
  <link rel="stylesheet" href="/css/manageAddProduct.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="../../../plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="../../../plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
  <link rel="stylesheet" href="../../../plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
</head>

<body class="hold-transition sidebar-mini layout-fixed" ng-app="myApp">
  <div class="wrapper">

    <!-- Preloader -->
    <div class="preloader flex-column justify-content-center align-items-center">
      <img class="animation__wobble" src="../../../dist/img/AdminLTELogo.png" alt="AdminLTELogo" height="60" width="60">
    </div>
    <nav ng-include="'../views/header.html'">

    </nav>
    <!-- /.navbar -->
    <aside ng-include="'../views/menu.html'"></aside>


    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <div class="content-header">
        <div class="container-fluid">
          <div class="row mb-2">
            <div class="col-sm-6">
              <h1 class="m-0">Quản Lý Sản Phẩm</h1>
            </div><!-- /.col -->
            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-right">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item">Dashboard v2</li>
              </ol>
            </div><!-- /.col -->
          </div><!-- /.row -->
        </div><!-- /.container-fluid -->
      </div>
      <!-- /.content-header -->

      <!-- Main content -->
      <section class="content">
        <div class="container-fluid">
          <div class="row">
            <section class="col-lg-12 connectedSortable">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Quản lý</h3>
                </div>
                <div class="card-body" style="padding: 0px;">
                  <main class="container-them-sanpham ">
                    <div class="container-col-1">
                      <form class="container-info-sanpham">
                        <div class="form-info-sanpham row">
                          <div class="info col-md-12">
                            <div class="lbl-info">
                              <label for="ten-sanpham" class="form-label">Tên sản phẩm <span
                                  style="color: red;">*</span>
                              </label>
                            </div>
                            <input type="text" class="form-control" id="ten-sanpham" placeholder="Nhập tên sản phẩm" />
                          </div>

                          <div class="info col-md-6">
                            <div class="lbl-info">
                              <label for="id-sanpham" class="form-label">Mã sản phẩm <span
                                  style="color: red;">*</span></label>
                            </div>
                            <input type="text" class="form-control" id="id-sanpham" />
                          </div>

                          <div class="info col-md-6">
                            <div class="lbl-info">
                              <label for="soluong-sanpham" class="form-label">Số lượng </label>
                            </div>
                            <input type="number" class="form-control" id="soluong-sanpham" value="1" />
                          </div>

                          <div class="info col-md-6">
                            <div class="lbl-info">
                              <label for="khoiluong-sanpham" class="form-label" value="0.00">Khối lượng <span
                                  style="color: red;">*</span></label>
                            </div>
                            <div class="input-group">
                              <input type="text" class="form-control" id="khoiluong-sanpham"
                                aria-describedby="khoiluong-sanpham2" required>
                              <span class="input-group-text" id="khoiluong-sanpham2">gram</span>
                            </div>
                          </div>

                          <div class="info col-md-6">
                            <div class="lbl-loai">
                              <label for="loai-sanpham" class="form-label">Loại sách</label>
                            </div>
                            <div class="loai-sanpham">
                              <select name="" id="loai-sanpham" class="form-control" style="width: 65%;">
                                <option value="">Ngôn tình</option>
                                <option value="">Sách giáo khoa</option>
                                <option value="">Kinh tế</option>
                                <option value="">Truyện ngắn</option>
                                <option value="">Tiểu thuyết Việt Nam</option>
                              </select>
                              <!-- Button trigger modal thêm sách -->
                              <div class="button-them">
                                <button class="btn btn-outline-success button-them-loai" type="button"
                                  data-bs-toggle="modal" data-bs-target="#exampleModal">Thao tác </button>
                                <button type="button" class="btn btn-outline-danger" style="width: 100px;">Xóa</button>
                              </div>
                              <!-- Modal -->
                              <div class="modal fade" id="exampleModal" tabindex="-1"
                                aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog modal-dialog-centered">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h1 class="modal-title fs-5" id="exampleModalLabel">Thêm loại sản phẩm </h1>
                                      <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body row">
                                      <div class="md-12 row-them-loaiSP">
                                        <label for="ma-loai">Mã loại<span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" id="ma-loai" placeholder="">
                                      </div>
                                      <div class="md-12  row-them-loaiSP">
                                        <label for="ten-loai">Tên loại<span style="color: red;">*</span></label>
                                        <input type="text" class="form-control" id="ten-loai" placeholder="">
                                      </div>
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-success" style="width: 100px;">Thêm
                                        mới</button>
                                      <button type="button" class="btn btn-outline-primary"
                                        style="width: 100px;">Sửa</button>
                                      <button type="button" class="btn btn-outline-danger"
                                        style="width: 100px;">Mới</button>

                                      <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal"
                                        style="width: 100px;">Thoát</button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="info col-md-6">
                            <div class="lbl-info">
                              <label for="tacgia-sanpham" class="form-label">Tác giả <span
                                  style="color: red;">*</span></label>
                            </div>
                            <input type="text" class="form-control" id="tacgia-sanpham" />
                          </div>

                          <div class="info col-md-6">
                            <div class="lbl-info">
                              <label for="nhaxuatban-sanpham" class="form-label">Nhà xuất bản</label>
                            </div>
                            <input type="text" class="form-control" id="nhaxuatban-sanpham" />
                          </div>

                          <div class="info col-md-12 row">
                            <div class="message"></div>
                            <div class="col-md-6 container-file-upload">
                              <label for="file-upload" class="form-label custom-file-upload">
                                <i class="fa fa-cloud-upload "></i> Đăng tải ảnh sản phẩm
                              </label>
                            </div>
                            <div class="col-md-6 save-image">
                              <div id="input-save-image">
                                <input type="file" class="form-control" id="file-upload" multiple="multiple"
                                  accept="image/png, image/jpeg, imgae/jpg" />
                              </div>
                              <div class="show-img-form slider">
                                <div class="container-images slides">
                                  <div class="show-img-div">
                                  </div>
                                </div>
                                <!-- <button class="prev" onclick="prevClick()">&#10094</button>
                                        <button class="next" onclick="nextClick()">&#10095</button> -->
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>

                      <div class="container-price-sanpham">
                        <div class="title">
                          <h6>Giá sản phẩm</h6>
                        </div>
                        <div class="info col-md-12">
                          <div class="lbl-info">
                            <label for="price-sanpham" class="form-label">Mức giá của sản phẩm <span
                                style="color: red;">*</span></label>
                          </div>
                          <div class="input-group">
                            <input type="number" class="form-control" id="gia-sanpham" value="0.00" min="0" />
                            <span class="input-group-text" id="khoiluong-sanpham2">VNĐ</span>
                          </div>
                        </div>
                        <div class="info col-md-12">
                          <div class="lbl-info">
                            <label for="sale-sanpham" class="form-label">Sale sản phẩm</label>
                          </div>
                          <div class="input-group">
                            <input type="number" class="form-control" id="sale-sanpham" value="0" min="0" max="100" />
                            <span class="input-group-text" id="sale-sanpham2">%</span>
                          </div>
                        </div>
                        <div class="status form-check col-md-12">
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" role="switch" id="allowed-sell" checked>
                            <label class="" for="allowed-sell">Cho phép bán</label>
                          </div>
                        </div>
                      </div>
                      <div class="container-button">

                        <button type="submit" class="btn btn-outline-success" style="width: 100px;">Thêm mới </button>
                        <button type="submit" class="btn btn-outline-primary" style="width: 100px;"> Sửa</button>
                        <button class="btn btn-outline-dark" style="width: 100px;">Mới</button>

                      </div>
                    </div>
                  </main>
                </div>
            </section>
            <!-- Table -->
            <section class="col-lg-12 connectedSortable">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Danh sách sản phẩm</h3>
                </div>
                <!-- /.card-header -->
                <div class="card-body">
                  <table id="example1" class="table table-bordered table-striped">
                    <thead>
                      <tr>
                        <th class="align-middle text-center">Mã sản phẩm</th>
                        <th colspan="2" class="align-middle text-center">Sản phẩm</th>
                        <th class="align-middle text-center">Tác giả</th>
                        <th class="align-middle text-center">Nhà xuất bản</th>
                        <th class="align-middle text-center">Số lượng</th>
                        <th class="align-middle text-center">Loại sách</th>
                        <th class="align-middle text-center">Ngày đăng</th>
                        <th class="align-middle text-center" style="width: 150px;">Thao tác</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="align-middle">7477467464</td>
                        <td class="align-middle"><img src="/img/books/SGK/muon-kiep-nhan-sinh.jpg" alt="" width="100px">
                        </td>
                        <td class="align-middle">Muôn kiếp nhân sinh</td>
                        <td class="align-middle">Nguyên Phong</td>
                        <td class="align-middle">NXB Tổng hợp TP.HCM</td>
                        <td class="align-middle">200</td>
                        <td class="align-middle">Tiểu thuyết</td>
                        <td class="align-middle">28/05/2024</td>
                        <td class="align-middle text-center">
                          <button class="btn btn-danger">Ngừng hoạt động</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <!-- /.card-body -->
          </div>
          <!-- /.card -->
      </section>


    </div>


  </div><!--/. container-fluid -->
  </section>
  <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->

  <!-- Main Footer -->
  <footer ng-include="'../views/footer.html'"></footer>
  </div>
  <!-- ./wrapper -->

  <!-- REQUIRED SCRIPTS -->
  <script src="../../../plugins/jquery/jquery.min.js"></script>
  <!-- Bootstrap 4 -->
  <script src="../../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- DataTables  & Plugins -->
  <script src="../../../plugins/datatables/jquery.dataTables.min.js"></script>
  <script src="../../../plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
  <script src="../../../plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
  <script src="../../../plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
  <script src="../../../plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
  <script src="../../../plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
  <script src="../../../plugins/jszip/jszip.min.js"></script>
  <script src="../../../plugins/pdfmake/pdfmake.min.js"></script>
  <script src="../../../plugins/pdfmake/vfs_fonts.js"></script>
  <script src="../../../plugins/datatables-buttons/js/buttons.html5.min.js"></script>
  <script src="../../../plugins/datatables-buttons/js/buttons.print.min.js"></script>
  <script src="../../../plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
  <!-- AdminLTE App -->
  <script src="../../../dist/js/adminlte.min.js"></script>
  <!-- AdminLTE for demo purposes -->
  <script src="../../../dist/js/demo.js"></script>
  <!-- Page specific script -->
  <script>
    $(function () {
      $("#example1").DataTable({
        "responsive": true, "lengthChange": false, "autoWidth": false,
        "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"]
      }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');
      $('#example2').DataTable({
        "paging": true,
        "lengthChange": false,
        "searching": false,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "responsive": true,
      });
    });
  </script>

  <script>
    var app = angular.module("myApp", []);
  </script>
  <script>
    let imagesArray = [];
    //INPUT
    containerInputSaveImage = document.querySelector("#input-save-image");
    inputSaveImage = document.querySelector("#file-upload");
    //SHOW
    containerShowImg = document.querySelector(".show-img-form");
    showImg = document.querySelector(".show-img-div");
    //Message
    message = document.querySelector(".message");
    deleteImage = [];

    // Hàm kiểm tra xem ảnh đã tồn tại trong mảng hay chưa
    function isImageExists(image) {
      return imagesArray.some(existingImage => {
        return existingImage.name === image.name; //so sánh theo tên ảnh
      });
    }

    //THÊM IMG
    if (inputSaveImage) {
      inputSaveImage.addEventListener("change", () => {
        const files = inputSaveImage.files;
        for (let index = 0; index < files.length; index++) {
          const image = files[index];
          const maxSize = 5 * 1024 * 1024; // 5 MB (có thể điều chỉnh theo nhu cầu)
          const allowedTypes = ['image/png', 'image/jpeg', 'image/jpg'];
          const newImageCount = event.target.files.length + showImg.childElementCount;

          // Kiểm tra xem ảnh đã tồn tại trong mảng hay chưa
          if (!isImageExists(image)) {
            imagesArray.push(image);
          } else {
            imagesArray.some(existingImage => {
              existingImage === image; //so sánh theo tên ảnh
            });
          }

          if (newImageCount > 3) {
            message.innerHTML = "Bạn chỉ có thể tải lên tối đa 3 ảnh.";
            message.style.cssText = "background-color:#f8d7da; color :#b71c1c";
            inputSaveImage.value = ''; // Reset file input
            return;
          } else if (event.target.files.length <= 3) {
            message.innerHTML = "";
            message.style.cssText = "";
          }

          if (image.size > maxSize) {
            message.innerHTML = "Kích thước file ảnh quá lớn, vui lòng chọn file khác.";
            message.style.cssText = "background-color: #f8d7da; color :#b71c1c";
            return;
          }
          // Kiểm tra loại file
          if (!allowedTypes.includes(image.type)) {
            message.innerHTML('Loại file không hợp lệ, vui lòng chọn file ảnh có định dạng PNG, JPEG hoặc JPG.');
            message.style.cssText = "background-color: #f8d7da; color :#b71c1c";
            return;
          }
        }
        displayImage();
      })
    } else {
      console.log("Element with id 'show-img-form' not found.");
    }

    // DISPLAY IMAGE
    function displayImage() {
      showImg.innerHTML = ""; // Xóa bỏ tất cả các phần tử hiện có trước khi tạo mới
      imagesArray.forEach((imageFile, index) => {
        // Tạo các phần tử ảnh và nút xóa
        const table = document.createElement('table');
        const col = document.createElement('col');

        const img = document.createElement('img');
        img.src = URL.createObjectURL(imageFile);
        img.alt = 'image';

        const span = document.createElement('span');
        span.textContent = '×';
        span.style.cursor = 'pointer';
        span.onclick = function () {
          imagesArray.splice(index, 1);
          displayImage();
        };

        // Thêm các phần tử vào container
        const imageContainer = document.createElement('div');
        imageContainer.classList.add('image');
        imageContainer.appendChild(img);
        imageContainer.appendChild(span);


        imageContainer.appendChild(table);
        table.appendChild(col);

        // Thêm container vào showImg
        showImg.appendChild(imageContainer);
        // slideShow();
      });
    }

    containerShowImg.addEventListener("submit", (e) => {
      e.preventDefault();
      sendImageToServer();
    });

    // table

    $(function () {
      $("#example1").DataTable({
        "responsive": true, "lengthChange": false, "autoWidth": false,
        "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"]
      }).buttons().container().appendTo('#example1_wrapper .col-md-6:eq(0)');
      $('#example2').DataTable({
        "paging": true,
        "lengthChange": false,
        "searching": false,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "responsive": true,
      });
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
    integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
    crossorigin="anonymous"></script>
</body>

</html>
